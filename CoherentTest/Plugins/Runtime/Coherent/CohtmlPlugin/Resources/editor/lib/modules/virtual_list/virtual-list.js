"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var VirtualList=function(){function t(){this.instantiated=!1}return t.prototype.init=function(t,e,i){var r=this;this.element=t,this.config=e,this.buffer=e.buffer,this.total=e.total,this.lastRepaint=null,this.scroller=e.scroller,this.itemsToRender=Math.ceil(this.scroller.height()/this.config.itemHeight)+this.buffer,this.vListDOM=i,this.instantiated=!0,this.scroller.off("scroll"),this.scroller.on("scroll",function(){s()});var s=function(){var t=r.getScrollPosition(),e=r.lastRepaint;t!==e&&(!e||Math.abs(e-t)>0)&&(r.lastRepaint=t,r.renderChunk())};return this.calculateScroll(),s(),this},t.prototype.listen=function(t,e){return document.body.addEventListener(t,e),this},t.prototype.stopListening=function(t,e){return document.body.removeEventListener(t,e),this},t.prototype.updateDOM=function(t){this.vListDOM=t,this.scroller.scrollTop(0),this.total=t.length,this.refresh()},t.prototype.calculateScroll=function(){this.element.css("height",this.total*this.config.itemHeight+"px"),this.scroller.height()<this.element.height()&&this.scroller.css("overflowY","scroll")},t.prototype.removeAsset=function(t){if(!this.instantiated)throw new Error("Cannot remove asset. The Virtual Library is not instantiated.");this.vListDOM.splice(Number(t),1),this.total-=1,this.vListDOM.forEach(function(t,e){t.style.top=34*e+"px",t.setAttribute("vList-index",String(e))}),this.refresh()},t.prototype.refresh=function(){if(!this.instantiated)throw new Error("Cannot rerender the library. The Virtual Library is not instantiated.");this.calculateScroll(),this.renderChunk()},t.prototype.destoy=function(){window.cancelAnimationFrame(this._renderAnimationFrame)},t.prototype.isInstantiated=function(){return this.instantiated},t.prototype.getScrollPosition=function(){return this.scroller.scrollTop()},t.prototype.renderChunk=function(){var t=this.getScrollPosition();this.itemsToRender=Math.ceil(this.scroller.height()/this.config.itemHeight)+2*this.buffer;var e=t/34<0?0:Math.ceil(t/34),i=e-this.buffer<=0?0:e-this.buffer;this.lastFrom=i;var r=i+this.itemsToRender,s=this.vListDOM.slice(i,r);this.element.html(""),this.element.append(s)},t.prototype.findIndex=function(t){var e=this.vListDOM.find(function(e){var i=e.querySelector("[data-link]");return!!i&&i.getAttribute("data-link")===t});return e?e.getAttribute("vlist-index"):null},t}();exports.default=VirtualList;